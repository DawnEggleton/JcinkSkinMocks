<!DOCTYPE html>
<html>
    <head>
        <title>Site Name</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <!--Styles-->
        <link rel="stylesheet" href="../css/styles.css" />
        <link rel="stylesheet" href="../css/packages/splide-core.min.css" />

        <!--Fonts-->
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Palanquin+Dark:wght@400;500;600;700&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Palanquin:wght@100;200;300;400;500;600;700&display=swap" rel="stylesheet"> 
        <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel="stylesheet"> 
        
        <!--Icons-->
		<link href="https://dawneggleton.github.io/JcinkSkinMocks/FA6/css/all.min.css" rel="stylesheet" />
		<link href="https://files.jcink.net/uploads/totl/saturnicons.css" rel="stylesheet" />
		<link href="https://files.jcink.net/uploads/totl/honeybee.css" rel="stylesheet" />
		<link href="https://files.jcink.net/uploads/totl/cappucicons.css" rel="stylesheet" />

        <!--Script Libraries-->
		<script type='text/javascript' src='https://files.jcink.net/html/jquery-1.7.2.min.js'></script>
		<script type='text/javascript' src='https://files.jcink.net/html/jquery.cookie-1.3.1.js'></script> 
		<script type='text/javascript' src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/2.2.2/isotope.pkgd.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@splidejs/splide@4.0.7/dist/js/splide.min.js"></script>
        <script src="../js/clipboard.js"></script>

        <!--Settings-->
        <script type='text/javascript' src='../js/settings.js'></script>
        <link rel="stylesheet" href="../css/settings.css" />
    </head>
    <body id="Members" class="dark g-4">
        
        <!--Header-->
        <header id="desktop-splide" class="splide" role="group"></header>
        <header id="mobile-splide" class="splide" role="group"></header>

        <!--Navigation-->
        <nav class="nav--desktop"></nav>
        <nav class="nav--mobile"></nav>

        <!--Main Body-->
        <main>
            <a name="top"></a>
            <form action='index.php' method='get'>
                <input type='hidden' name='act' value='Members' />
                <div class="members">
                    <div class="members--options">
                        <tag-tabs class="members--border">
                            <tag-labels>
                                <button onclick="moveLeft(this)" type="button"><i class="fa-solid fa-angles-left"></i></button>
                                <tag-labelset>
                                    <input type="text" placeholder="Filter by Name" id="quicksearch" class="members--namesearch" />
                                    <tag-label class="is-active">members</tag-label>
                                    <tag-label>account type</tag-label>
                                    <tag-label>group</tag-label>
                                    <!--<tag-label>disciplines</tag-label>-->
                                    <tag-label>age</tag-label>
                                    <tag-label>relationship</tag-label>
                                    <tag-label>sort results</tag-label>
                                </tag-labelset>
                                <button onclick="moveRight(this)" type="button"><i class="fa-solid fa-angles-right"></i></button>
                            </tag-labels>
                            <tag-tabset>
                                <tag-tab class="members--filter-group members--generate-alias" data-filter-group="member">
                                    <tag-labels>
                                        <button onclick="moveLeft(this)" type="button"><i class="fa-solid fa-angles-left"></i></button>
                                        <tag-labelset>
                                            <label class="all is-checked"><input type="checkbox" class="all" value="" checked=""><span>all</span></label>
                                        </tag-labelset>
                                        <button onclick="moveRight(this)" type="button"><i class="fa-solid fa-angles-right"></i></button>
                                    </tag-labels>
                                </tag-tab>
                                <tag-tab class="members--filter-group" data-filter-group="type">
                                    <tag-labels>
                                        <button onclick="moveLeft(this)" type="button"><i class="fa-solid fa-angles-left"></i></button>
                                        <tag-labelset>
                                            <label class="all is-checked"><input type="checkbox" class="all" value="" checked=""><span>all</span></label>
                                            <label><input type="checkbox" value=".g-4"><span>Staff</span></label>
                                            <label><input type="checkbox" value=".g-6"><span>Writers</span></label>
                                            <label><input type="checkbox" value=".active"><span>Active Characters</span></label>
                                            <label><input type="checkbox" value=".g-3"><span>Unsorted</span></label>
                                            <label><input type="checkbox" value=".g-7"><span>Inactive</span></label>
                                            <label><input type="checkbox" value=".g-8"><span>Hiatus</span></label>
                                        </tag-labelset>
                                        <button onclick="moveRight(this)" type="button"><i class="fa-solid fa-angles-right"></i></button>
                                    </tag-labels>
                                </tag-tab>
                                <tag-tab class="members--filter-group" data-filter-group="group">
                                    <tag-labels>
                                        <button onclick="moveLeft(this)" type="button"><i class="fa-solid fa-angles-left"></i></button>
                                        <tag-labelset>
                                            <label class="all is-checked"><input type="checkbox" class="all" value="" checked=""><span>all</span></label>
                                            <label><input type="checkbox" value=".g-9"><span>International</span></label>
                                            <label><input type="checkbox" value=".g-10"><span>National</span></label>
                                            <label><input type="checkbox" value=".g-11"><span>Provincial</span></label>
                                            <label><input type="checkbox" value=".g-12"><span>Schooling</span></label>
                                            <label><input type="checkbox" value=".g-13"><span>Industry</span></label>
                                            <label><input type="checkbox" value=".g-14"><span>Local</span></label>
                                        </tag-labelset>
                                        <button onclick="moveRight(this)" type="button"><i class="fa-solid fa-angles-right"></i></button>
                                    </tag-labels>
                                </tag-tab>
                                <!--<tag-tab class="members--filter-group members--generate-disciplines" data-filter-group="disciplines">
                                    <tag-labels>
                                        <button onclick="moveLeft(this)" type="button"><i class="fa-solid fa-angles-left"></i></button>
                                        <tag-labelset>
                                            <label class="all is-checked"><input type="checkbox" class="all" value="" checked=""><span>all</span></label>
                                        </tag-labelset>
                                        <button onclick="moveRight(this)" type="button"><i class="fa-solid fa-angles-right"></i></button>
                                    </tag-labels>
                                </tag-tab>-->
                                <tag-tab class="members--filter-group" data-filter-group="age">
                                    <tag-labels>
                                        <button onclick="moveLeft(this)" type="button"><i class="fa-solid fa-angles-left"></i></button>
                                        <tag-labelset>
                                            <label class="all is-checked"><input type="checkbox" class="all" value="" checked=""><span>all</span></label>
                                            <label><input type="checkbox" value=".Teen"><span>18-29</span></label>
                                            <label><input type="checkbox" value=".30s"><span>30-39</span></label>
                                            <label><input type="checkbox" value=".40s"><span>40-49</span></label>
                                            <label><input type="checkbox" value=".50"><span>50+</span></label>
                                        </tag-labelset>
                                        <button onclick="moveRight(this)" type="button"><i class="fa-solid fa-angles-right"></i></button>
                                    </tag-labels>
                                </tag-tab>
                                <tag-tab class="members--filter-group" data-filter-group="relationship">
                                    <tag-labels>
                                        <button onclick="moveLeft(this)" type="button"><i class="fa-solid fa-angles-left"></i></button>
                                        <tag-labelset>
                                            <label class="all is-checked"><input type="checkbox" class="all" value="" checked=""><span>all</span></label>
                                            <label><input type="checkbox" value=".single"><span>Single</span></label>
                                            <label><input type="checkbox" value=".dating"><span>Dating</span></label>
                                            <label><input type="checkbox" value=".engaged"><span>Engaged</span></label>
                                            <label><input type="checkbox" value=".married"><span>Married</span></label>
                                            <label><input type="checkbox" value=".separated"><span>Separated</span></label>
                                            <label><input type="checkbox" value=".divorced"><span>Divorced</span></label>
                                            <label><input type="checkbox" value=".widowed"><span>Widowed</span></label>
                                        </tag-labelset>
                                        <button onclick="moveRight(this)" type="button"><i class="fa-solid fa-angles-right"></i></button>
                                    </tag-labels>
                                </tag-tab>
                                <tag-tab class="members--sort-options">
                                    <tag-labels>
                                        <button onclick="moveLeft(this)" type="button"><i class="fa-solid fa-angles-left"></i></button>
                                        <tag-labelset>
                                            <button type="button" class="members--sort is-active" data-sort="name"><span>Name (A -&gt; Z)</span></button>
                                            <button type="button" class="members--sort" data-sort="nameDesc"><span>Name (Z -&gt; A)</span></button>
                                            <button type="button" class="members--sort" data-sort="age"><span>Age (Asc)</span></button>
                                            <button type="button" class="members--sort" data-sort="ageDesc"><span>Age (Desc)</span></button>
                                            <button type="button" class="members--sort" data-sort="face"><span>Face (A -&gt; Z)</span></button>
                                            <button type="button" class="members--sort" data-sort="faceDesc"><span>Face (Z -&gt; A)</span></button>
                                        </tag-labelset>
                                        <button onclick="moveRight(this)" type="button"><i class="fa-solid fa-angles-right"></i></button>
                                    </tag-labels>
                                </tag-tab>
                            </tag-tabset>
                        </tag-tabs>
                    </div>
                    <div class="members--list"></div>
                    <script>
                        let html = ``;
                        let accounts = [], members = [], membersClean = [], disciplines = [], disciplinesClean = [];
                        let $container = $('.members--list');
                        var filters = {};
                        let charAge = `0`, ageClass = ``;

                        function sortList(el, direction) {
                            let sort = el.getAttribute('data-sort');
                            accounts.sort((a, b) => {
                                let aSort = a[sort];
                                let bSort = b[sort];
                                if(a['type'] != 'Member' && b['type'] != 'Member') {
                                    if (aSort === bSort) {
                                        return 0;
                                    }
                                    else if (aSort === `` || !aSort) {
                                        return 1;
                                    }
                                    else if (bSort === `` || !bSort) {
                                        return -1;
                                    }
                                    else if (direction === `asc` && aSort !== `` && bSort !== ``) {
                                        return aSort < bSort ? -1 : 1;
                                    }
                                    else if (direction === `desc` && aSort !== `` && bSort !== ``) {
                                        return aSort < bSort ? 1 : -1;
                                    }
                                } else {
                                    if (a['type'] == 'Member') {
                                        return 1;
                                    } else if (b['type'] == 'Member') {
                                        return -1;
                                    } else {
                                        return 0;
                                    }
                                }
                            });
                            populatePage(accounts);
                            $container.isotope('reloadItems').isotope();
                        }
                        
                        function populatePage(array) {
                            for (let i = 0; i < array.length; i++) {
                                //Make Member Array
                                let member = {raw: array[i].rawAlias, clean: array[i].alias};
                                if(jQuery.inArray(member.clean, membersClean) == -1 && member.clean != '') {
                                    membersClean.push(member.clean);
                                    members.push(member);
                                }
                                //make disciplines array
                                let characterDisciplines = array[i].disciplinesArray;
                                for (let j = 0; j < characterDisciplines.length; j++) {
                                    let discipline = {raw: array[i].disciplinesArray[j], clean: array[i].disciplinesArray[j].toLowerCase().replace(' ', "").replace('\/', "")};
                                    if(jQuery.inArray(discipline.clean, disciplinesClean) == -1 && discipline.clean != '') {
                                        disciplines.push(discipline);
                                        disciplinesClean.push(discipline.clean);
                                    }
                                }
                                switch(array[i].groupID) {
                                    //member only
                                    case 4:
                                    case 6:
                                        html += `<div class="members--member writer onLoad grid-item g-${array[i].groupID} ${array[i].alias}">
                                            <div class="member">
                                                <div class="member--border">
                                                    <div class="member--top">
                                                        <a href="profile-member.html" class="name">${array[i].splitName}</a>
                                                        <div class="member--links">
                                                            <a href="profile-member.html">directory</a>
                                                            <a href="defaults/usertopics.html">topics</a>
                                                            <a href="defaults/userposts.html">posts</a>
                                                        </div>
                                                    </div>
                                                    <div class="member--image">
                                                        <img src="${array[i].imageTall}" class="tall" />
                                                        <img src="${array[i].imageWide}" class="wide" />
                                                    </div>
                                                    <div class="member--info">
                                                        <div class="member--overview"><div class="scroll">${array[i].limits}</div></div>
                                                        <div class="member--quick-facts">
                                                            <div class="member--fact">
                                                                <b>pronouns</b>
                                                                <span>${array[i].memPronouns}</span>
                                                            </div>
                                                            <div class="member--fact">
                                                                <b>timezone</b>
                                                                <span>${array[i].timezone}</span>
                                                            </div>
                                                            <div class="member--fact">
                                                                <b>posting</b>
                                                                <span>${array[i].frequency}</span>
                                                            </div>
                                                            <div class="member--fact">
                                                                <b>joined</b>
                                                                <span>${array[i].joined}</span>
                                                            </div>
                                                            <div class="member--fact">
                                                                <b>last posted</b>
                                                                <span>${array[i].lastpost}</span>
                                                            </div>
                                                            <div class="member--fact">
                                                                <b>limits</b>
                                                                <span>${array[i].writeLimits}</span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="member--search-terms">
                                                        <span class="search-name">${array[i].name}</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>`;
                                        break;
                                    //depends on type
                                    case 1:
                                    case 5:
                                    case 7:
                                    case 8:
                                        if(array[i].type == `member`) {
                                            //member
                                            html += `<div class="members--member writer grid-item g-${array[i].groupID} ${array[i].alias}">
                                                <div class="member">
                                                    <div class="member--border">
                                                        <div class="member--top">
                                                            <a href="profile-member.html" class="name">${array[i].splitName}</a>
                                                            <div class="member--links">
                                                                <a href="profile-member.html">directory</a>
                                                                <a href="defaults/usertopics.html">topics</a>
                                                                <a href="defaults/userposts.html">posts</a>
                                                            </div>
                                                        </div>
                                                        <div class="member--image">
                                                            <img src="${array[i].imageTall}" class="tall" />
                                                            <img src="${array[i].imageWide}" class="wide" />
                                                        </div>
                                                        <div class="member--info">
                                                            <div class="member--overview"><div class="scroll">${array[i].limits}</div></div>
                                                            <div class="member--quick-facts">
                                                                <div class="member--fact">
                                                                    <b>pronouns</b>
                                                                    <span>${array[i].pronouns}</span>
                                                                </div>
                                                                <div class="member--fact">
                                                                    <b>timezone</b>
                                                                    <span>${array[i].timezone}</span>
                                                                </div>
                                                                <div class="member--fact">
                                                                    <b>posting</b>
                                                                    <span>${array[i].frequency}</span>
                                                                </div>
                                                                <div class="member--fact">
                                                                    <b>joined</b>
                                                                    <span>${array[i].joined}</span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="member--search-terms">
                                                            <span class="search-name">${array[i].name}</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>`;
                                        } else {
                                            //character
                                            html += `<div class="members--member character grid-item g-${array[i].groupID} ${array[i].ageClass} ${array[i].relStatus} ${array[i].alias} ${array[i].groupName} ${array[i].disciplinesClass}">
                                                <div class="member">
                                                    <div class="member--border">
                                                        <div class="member--top">
                                                            <a href="profile.html" class="name">${array[i].splitName}</a>
                                                            <div class="member--links">
                                                                <a href="profile-member.html">directory</a>
                                                                <a href="defaults/usertopics.html">topics</a>
                                                                <a href="defaults/userposts.html">posts</a>
                                                            </div>
                                                        </div>
                                                        <div class="member--image">
                                                            <img src="${array[i].imageTall}" class="tall" />
                                                            <img src="${array[i].imageWide}" class="wide" />
                                                        </div>
                                                        <div class="member--info">
                                                            <div class="member--overview"><div class="scroll">${array[i].overview}</div></div>
                                                            <div class="member--quick-facts">
                                                                <div class="member--fact">
                                                                    <b>pronouns</b>
                                                                    <span>${array[i].pronouns}</span>
                                                                </div>
                                                                <div class="member--fact">
                                                                    <b>age</b>
                                                                    <span>${array[i].age} years old</span>
                                                                </div>
                                                                <div class="member--fact">
                                                                    <b>currently</b>
                                                                    <span>${array[i].relStatus}</span>
                                                                </div>
                                                                <div class="member--fact">
                                                                    <b>played by</b>
                                                                    <span>${array[i].rawAlias}</span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="member--search-terms">
                                                            <span class="search-name">${array[i].name}</span>
                                                            <span class="sort-name">${array[i].name}</span>
                                                            <span class="sort-age">${array[i].age}</span>
                                                            <span class="sort-face">${array[i].face}</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>`;
                                        }
                                        break;
                                    //unsorted
                                    case 3:
                                        if(array[i].type == `member`) {
                                            //member
                                            html += `<div class="members--member writer onLoad grid-item g-${array[i].groupID} ${array[i].alias}">
                                                <div class="member">
                                                    <div class="member--border">
                                                        <div class="member--top">
                                                            <a href="profile-member.html" class="name">${array[i].splitName}</a>
                                                            <div class="member--links">
                                                                <a href="profile-member.html">directory</a>
                                                                <a href="defaults/usertopics.html">topics</a>
                                                                <a href="defaults/userposts.html">posts</a>
                                                            </div>
                                                        </div>
                                                        <div class="member--image">
                                                            <img src="${array[i].imageTall}" class="tall" />
                                                            <img src="${array[i].imageWide}" class="wide" />
                                                        </div>
                                                        <div class="member--info">
                                                            <div class="member--overview"><div class="scroll">${array[i].limits}</div></div>
                                                            <div class="member--quick-facts">
                                                                <div class="member--fact">
                                                                    <b>pronouns</b>
                                                                    <span>${array[i].pronouns}</span>
                                                                </div>
                                                                <div class="member--fact">
                                                                    <b>timezone</b>
                                                                    <span>${array[i].timezone}</span>
                                                                </div>
                                                                <div class="member--fact">
                                                                    <b>posting</b>
                                                                    <span>${array[i].frequency}</span>
                                                                </div>
                                                                <div class="member--fact">
                                                                    <b>joined</b>
                                                                    <span>${array[i].joined}</span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="member--search-terms">
                                                            <span class="search-name">${array[i].name}</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>`;
                                        } else {
                                            //character
                                            html += `<div class="members--member character onLoad grid-item g-${array[i].groupID} ${array[i].ageClass} ${array[i].relStatus} ${array[i].alias} ${array[i].groupName} ${array[i].disciplinesClass}">
                                                <div class="member">
                                                    <div class="member--border">
                                                        <div class="member--top">
                                                            <a href="profile.html" class="name">${array[i].splitName}</a>
                                                            <div class="member--links">
                                                                <a href="profile-member.html">directory</a>
                                                                <a href="defaults/usertopics.html">topics</a>
                                                                <a href="defaults/userposts.html">posts</a>
                                                            </div>
                                                        </div>
                                                        <div class="member--image">
                                                            <img src="${array[i].imageTall}" class="tall" />
                                                            <img src="${array[i].imageWide}" class="wide" />
                                                        </div>
                                                        <div class="member--info">
                                                            <div class="member--overview"><div class="scroll">${array[i].overview}</div></div>
                                                            <div class="member--quick-facts">
                                                                <div class="member--fact">
                                                                    <b>pronouns</b>
                                                                    <span>${array[i].pronouns}</span>
                                                                </div>
                                                                <div class="member--fact">
                                                                    <b>age</b>
                                                                    <span>${array[i].age} years old</span>
                                                                </div>
                                                                <div class="member--fact">
                                                                    <b>currently</b>
                                                                    <span>${array[i].relStatus}</span>
                                                                </div>
                                                                <div class="member--fact">
                                                                    <b>played by</b>
                                                                    <span>${array[i].rawAlias}</span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="member--search-terms">
                                                            <span class="search-name">${array[i].name}</span>
                                                            <span class="sort-name">${array[i].name}</span>
                                                            <span class="sort-age">${array[i].age}</span>
                                                            <span class="sort-face">${array[i].face}</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>`;
                                        }
                                        break;
                                    //character only
                                    default: 
                                        html += `<div class="members--member character active onLoad grid-item g-${array[i].groupID} ${array[i].ageClass} ${array[i].relStatus} ${array[i].alias} ${array[i].groupName} ${array[i].disciplinesClass}">
                                            <div class="member">
                                                <div class="member--border">
                                                    <div class="member--top">
                                                        <a href="profile.html" class="name">${array[i].splitName}</a>
                                                        <div class="member--links">
                                                            <a href="profile-member.html">directory</a>
                                                            <a href="defaults/usertopics.html">topics</a>
                                                            <a href="defaults/userposts.html">posts</a>
                                                        </div>
                                                    </div>
                                                    <div class="member--image">
                                                        <img src="${array[i].imageTall}" class="tall" />
                                                        <img src="${array[i].imageWide}" class="wide" />
                                                    </div>
                                                    <div class="member--info">
                                                        <div class="member--overview"><div class="scroll">${array[i].overview}</div></div>
                                                        <div class="member--quick-facts">
                                                            <div class="member--fact">
                                                                <b>pronouns</b>
                                                                <span>${array[i].pronouns}</span>
                                                            </div>
                                                            <div class="member--fact">
                                                                <b>age</b>
                                                                <span>${array[i].age} years old</span>
                                                            </div>
                                                            <div class="member--fact">
                                                                <b>currently</b>
                                                                <span>${array[i].relStatus}</span>
                                                            </div>
                                                            <div class="member--fact">
                                                                <b>played by</b>
                                                                <span>${array[i].rawAlias}</span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="member--search-terms">
                                                        <span class="search-name">${array[i].name}</span>
                                                        <span class="sort-name">${array[i].name}</span>
                                                        <span class="sort-age">${array[i].age}</span>
                                                        <span class="sort-face">${array[i].face}</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>`;
                                        break;
                                }
                            }
                            document.querySelector('.members--list').insertAdjacentHTML('beforeend', html);

                            //sort arrays
                            members.sort();
                            disciplines.sort();


                            //Append Array
                            members.forEach(member => {
                                document.querySelector('.members--generate-alias tag-labelset').insertAdjacentHTML('beforeend', `<label><input type="checkbox" value=".${member.clean}"/><span>${member.raw}</span></label>`);
                            });

                            //Append Disciplines
                            /*disciplines.forEach(discipline => {
                                document.querySelector('.members--generate-disciplines tag-labelset').insertAdjacentHTML('beforeend', `<label><input type="checkbox" value=".${discipline.clean}"/><span>${discipline.raw}</span></label>`);
                            });*/
                        }

                        function setCustomFilter() {
                            //get search value
                            qsRegex = document.querySelector('#quicksearch').value;
                            
                            //add show class to all items to reset
                            elements.forEach(el => el.classList.add('show'));
                            
                            //filter by nothing
                            let searchFilter = '';
                            
                            //check each item
                            elements.forEach(el => {
                                let name = el.querySelector('.search-name').textContent;
                                if(!name.toLowerCase().includes(qsRegex)) {
                                    el.classList.remove('show');
                                    searchFilter = '.show';
                                }
                            });
                        
                            let filterGroups = document.querySelectorAll('.members--filter-group');
                            let groups = [];
                            let checkFilters;
                            filterGroups.forEach(group => {
                                let filters = [];
                                group.querySelectorAll('label.is-checked input').forEach(filter => {
                                    if(filter.value) {
                                        filters.push(filter.value);
                                    }
                                });
                                groups.push({group: group.dataset.filterGroup, selected: filters});
                            });
                        
                            let filterCount = 0;
                            let comboFilters = [];
                            groups.forEach(group => {
                                // skip to next filter group if it doesn't have any values
                                if ( group.selected.length > 0 ) {
                                    if ( filterCount === 0 ) {
                                        // copy groups to comboFilters
                                        comboFilters = group.selected;
                                    } else {
                                        var filterSelectors = [];
                                        var groupCombo = comboFilters;
                                        // merge filter Groups
                                        for (var k = 0; k < group.selected.length; k++) {
                                            for (var j = 0; j < groupCombo.length; j++) {
                                                //accommodate weirdness with object vs not
                                                if(groupCombo[j].selected) {
                                                    if(groupCombo[j].selected != group.selected[k]) {
                                                        filterSelectors.push( groupCombo[j].selected + group.selected[k] );
                                                    }
                                                } else if (!groupCombo[j].selected && group.selected[k]) {
                                                    if(groupCombo[j] != group.selected[k]) {
                                                        filterSelectors.push( groupCombo[j] + group.selected[k] );
                                                    }
                                                }
                                            }
                                        }
                                        // apply filter selectors to combo filters for next group
                                        comboFilters = filterSelectors;
                                    }
                                    filterCount++;
                                }
                            });
                            
                            //set filter to blank
                            let filter = [];
                            //check if it's only search
                            if(qsRegex.length > 0 && comboFilters.length === 0) {
                                filter = ['.show'];
                            }
                            //check if it's only checkboxes
                            else if(qsRegex.length === 0 && comboFilters.length > 0) {
                                let combos = comboFilters.join(',').split(',');
                                filter = [...combos];
                            }
                            //check if it's both
                            else if (qsRegex.length > 0 && comboFilters.length > 0) {
                                let dualFilters = comboFilters.map(filter => filter + '.show');
                                filter = [...dualFilters];
                            }
                        
                            //join array into string
                            filter = filter.join(', ');
                            
                            //render isotope
                            $container.isotope({
                                filter: filter
                            });
                        }
                    
                        // debounce so filtering doesn't happen every millisecond
                        function debounce(fn, threshold) {
                            var timeout;
                            return function debounced() {
                                if (timeout) {
                                clearTimeout(timeout);
                                }
                        
                                function delayed() {
                                fn();
                                timeout = null;
                                }
                                setTimeout(delayed, threshold || 100);
                            };
                        }

                        accounts = fakeAccounts;

                        populatePage(accounts);

                        //initialize isotope
                        // quick search regex
                        let qsRegex;
                        let elements = document.querySelectorAll('.grid-item');

                        
                        // init Isotope
                        $container.isotope({
                            itemSelector: '.grid-item',
                            percentPosition: true,
                            filter: '.onLoad',
                            getSortData: {
                                name: '.sort-name',
                                nameDesc: '.sort-name',
                                age: '.sort-age parseInt',
                                ageDesc: '.sort-age parseInt',
                                face: '.sort-face',
                                faceDesc: '.sort-face',
                            },
                            sortAscending: {
                                name: true,
                                nameDesc: false,
                                age: true,
                                ageDesc: false,
                                face: true,
                                faceDesc: false,
                            }
                        });
                    
                        //use value of input select to filter
                        let checkboxes = document.querySelectorAll('.members--filter-group input');
                        checkboxes.forEach(checkbox => {
                            checkbox.addEventListener('change', e => {
                                const url = new URL(window.location.href);
                                if(e.currentTarget.classList.contains('all')) {
                                    e.currentTarget.checked = true;
                                    e.currentTarget.parentElement.classList.add('is-checked');
                                    e.currentTarget.parentElement.parentElement.querySelectorAll('input:not(.all)').forEach(input => {
                                        input.checked = false;
                                        input.parentElement.classList.remove('is-checked');
                                    });
                                } else {
                                    if(e.currentTarget.parentElement.classList.contains('is-checked')) {
                                        e.currentTarget.checked = false;
                                        e.currentTarget.parentElement.classList.remove('is-checked');
                                    } else {
                                        e.currentTarget.checked = true;
                                        e.currentTarget.parentElement.classList.add('is-checked');
                                        e.currentTarget.parentElement.parentElement.querySelector('input.all').checked = false;
                                        e.currentTarget.parentElement.parentElement.querySelector('input.all').parentElement.classList.remove('is-checked');
                                    }
                                }
                                let labels = e.currentTarget.parentElement.parentElement.querySelectorAll('label');
                                let checked = 0;
                                labels.forEach(label => {
                                    if(label.classList.contains('is-checked')) {
                                        checked++;
                                    }
                                });
                                if(checked === 0) {
                                    e.currentTarget.parentElement.parentElement.querySelector('input.all').checked = true;
                                    e.currentTarget.parentElement.parentElement.querySelector('input.all').parentElement.classList.add('is-checked');
                                }
                                //set filters
                                setCustomFilter();
                            });
                        });
                        
                        // use value of search field to filter
                        document.querySelector('#quicksearch').addEventListener('keyup', e => {
                            setCustomFilter();
                        });

                        // bind sort button click
                        let sortButtons = document.querySelectorAll('button.members--sort');
                        sortButtons.forEach(button => {
                            button.addEventListener('click', e => {
                                let sortValue = e.currentTarget.dataset.sort;
                                $container.isotope({ sortBy: sortValue });
                                sortButtons.forEach(button => {
                                    button.classList.remove('is-active');
                                });
                                e.currentTarget.classList.add('is-active');
                            });
                        });
                    </script>
                </div>
            </form>
        </main>

        <!-- Copyright Information -->
        <div class="tableborder" align="center">
            <div class="row4" style="font-size: 7.5pt; padding-top: 1px; padding-bottom: 1px; line-height: 8pt;">
                <div class="copyright" align="center">
                    Powered by 
                    <a href="https://www.invisionboard.com" target="_blank">Invision Power Board</a>
                    (<a href="http://jcink.com" target="_blank">Jcink.com </a>
                    <a href="https://jcink.com" target="_blank">Forum Hosting</a>
                    ) © 2020 &nbsp;
                    <a href="https://www.invisionpower.com" target="_blank">IPS, Inc.</a>
                    <br>
                    Page creation time: 0.0054 <!-- http://luxtradition.b1.jcink.com -->  · 
                    <a href="index.php?act=Mobile">Mobile Version</a> · 
                    <a href="index.php?act=privacy">Privacy Policy</a>
                </div>
            </div>
        </div> 

        <!--Scripts-->
        <script src="templates/import-templates.js"></script>
        <script src="../js/functions.js"></script>
        <script src="../js/scripts.js"></script>
    </body>
</html>